---
jupytext:
  cell_metadata_filter: -all
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.10.3
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Exercise 1: Finding Michel electrons

Michel electrons come out of a muon decay. They are electrons, so they look like
an electromagnetic shower coming out of a long muon track. 

Stages of the chain required: UResNet only!

```{note} TODO
Write solutions.
```

## Motivation
Michel electrons are used in LArTPC
experiments as "candles": we understand their energy spectrum very well, so they
can be used to calibrate the detector and to compare the quality of different detectors.
Michel electrons spectrum is one of the first "tokens" that an experiment will show to
prove that the detector is running and we can successfully reconstruct the data.
Since their energy is in a range up to ~50MeV, they are also representative of the 
detector response to electromagnetic particles generated by neutrino activity.

```{figure} https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQsezzzPeMfyra-aaqqooRh-IAVN61XbgDDuQ&usqp=CAU
Example of Michel electron spectrum
```

## What are we looking for?


```{figure} ./electron_stopping_power.png
---
figclass: margin
---
Energy loss per unit distance (MeV/cm) for electrons traveling in liquid argon. From {cite}`MicrobooneMichel`.
```

The primary Michel electron that comes out of the muon decay-at-rest can lose energy
either through ionization (collision stopping power), or through the production of 
radiative photons via Bremsstrahlung (radiative stopping power). Beyond a certain energy,
the radiative stopping power is greater than the collision stopping power. If the radiative
photons have enough energy, they can pair-produce, i.e. turn into an electron-positron pair.
They, in turn, can produce new radiative photons, and so on. They can also undergo Compton scattering.
A cascade of electrons and photons (electromagnetic shower) happens.



Ionization produces track-like energy depositions, whereas the photons can travel
some distance before converting into a secondary electron. Hence Michel electrons have 
two clear topological features: a primary ionization, which is track-like at the end
of the muon track, and some scattered energy deposits much further away which come from 
these radiative photons.

```{figure} ./michel.png
---
height: 300px
---
Example of Michel electron topology
```

In this exercise, we are only concerned with finding the primary ionization of the Michel electron. 
We will purposefully ignore for now the radiative photons.

## Step 1: extract the semantic segmentation predictions.
Get the UResNet semantic segmentation predictions from the chain output.

```{code-cell}
:tags: [hide-cell]

some solution code here
```

## Step 2: identify muons and electrons particles.
Use the predictions that you retrieved and a simple clustering algorithm
such as DBSCAN to isolate muons and electron particle instances (groups
of voxels).

```{code-cell}
:tags: [hide-cell]

some solution code here
```

## Step 3: make sure the electron is touching the end of the muon track.
There can be many ways to do this check.

```{code-cell}
:tags: [hide-cell]

some solution code here
```

## Step 4: make a plot!
Let's use the voxel count as a substitute for the reconstructed energy. This 
approximation is fairly accurate for shower-like particles. Make a histogram with
Michel electron candidates voxel counts. 

```{code-cell}
:tags: [hide-cell]

some solution code here
```

## Other readings
Michel Electron Reconstruction Using
Cosmic-Ray Data from the MicroBooNE LArTPC
https://lss.fnal.gov/archive/2017/pub/fermilab-pub-17-090-nd.pdf


```{bibliography}
:style: alpha
```